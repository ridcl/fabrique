{
	"name": "Existing Dockerfile",
	"build": {
		"context": "..",
		"dockerfile": "../Dockerfile",
		"target": "build-dev"
	},

	"mounts": [
		"source=${localEnv:HOME}/.cache/huggingface/,target=/home/devpod/.cache/huggingface/,type=bind,consistency=cached",
		"source=${localEnv:HOME}/data/,target=/data/,type=bind,consistency=cached"
	],

	"containerEnv": {
		"PYTHONPATH": "src",
		"HF_TOKEN": "${localEnv:HF_TOKEN_PERSONAL}",
		"JAX_COMPILATION_CACHE_DIR": "/tmp/jax_cache",
		"XLA_PYTHON_CLIENT_MEM_FRACTION": ".99",
		"TF_GPU_ALLOCATOR": "cuda_malloc_async",  // mitigates fragmentation
		"XLA_FLAGS": "--xla_gpu_enable_command_buffer="
	},

	"customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python"
            ]
        }
    },

	"postCreateCommand": "bash .devcontainer/init.sh",

	"runArgs": ["--gpus", "all", "--shm-size", "2g"]

}